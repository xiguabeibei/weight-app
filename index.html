<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="å¥åº·å°æœ¬æœ¬">
<title>å¥åº·å°æœ¬æœ¬</title>

<style>
:root{
 --pink:#ff8fb1;
 --purple:#a78bfa;
 --blue:#67e8f9;
 --green:#86efac;
 --bg:linear-gradient(160deg,#fff1f7,#eef4ff);
 --card:#ffffffee;
 --text:#222;
}
body{
 margin:0;
 font-family:-apple-system,BlinkMacSystemFont,"PingFang SC";
 background:var(--bg);
 color:var(--text);
}
.app{display:flex;height:100vh;}
.sidebar{
 width:280px;
 padding:28px;
 background:linear-gradient(180deg,var(--pink),var(--purple));
 color:#fff;
}
.sidebar h1{font-size:24px;margin-bottom:16px;}
.sidebar select,
.sidebar input{
 width:100%;
 padding:14px;
 border-radius:16px;
 border:none;
 margin-bottom:14px;
 font-size:16px;
}
.sidebar button{
 width:100%;
 margin-bottom:12px;
 padding:16px;
 border:none;
 border-radius:18px;
 background:#ffffff33;
 color:#fff;
 font-size:17px;
}
.main{flex:1;padding:36px;overflow:auto;}
.card{
 background:var(--card);
 border-radius:32px;
 padding:28px;
 margin-bottom:26px;
 box-shadow:0 24px 50px rgba(0,0,0,.15);
}
h2{margin-top:0;font-size:22px;}
input{
 width:100%;
 padding:18px;
 border-radius:18px;
 border:1px solid #ddd;
 margin-bottom:16px;
 font-size:18px;
}
.primary{
 background:linear-gradient(135deg,var(--pink),var(--purple));
 color:#fff;
 border:none;
 padding:18px;
 border-radius:999px;
 width:100%;
 font-size:18px;
}
.chart{
 height:280px;
 display:flex;
 align-items:flex-end;
 gap:12px;
}
.bar{
 flex:1;
 background:linear-gradient(180deg,var(--blue),var(--purple));
 border-radius:14px 14px 8px 8px;
 animation:grow .6s ease forwards;
}
@keyframes grow{from{height:0}to{height:var(--h)}}
.tip{font-size:20px;color:var(--pink);}
</style>
</head>

<body>
<div class="app">

<div class="sidebar">
<h1>å¥åº·å°æœ¬æœ¬</h1>

<select id="userSelect" onchange="changeUser()">
<option value="">é€‰æ‹©ä½¿ç”¨è€…</option>
</select>

<input id="newUser" placeholder="æ–°å¢å®¶åº­æˆå‘˜">
<button onclick="addUser()">æ·»åŠ æˆå‘˜</button>

<button onclick="show('weight')">âš–ï¸ ä½“é‡</button>
<button onclick="show('food')">ğŸš é¥®é£Ÿ</button>
<button onclick="show('sport')">ğŸƒ è¿åŠ¨</button>
<button onclick="show('summary')">ğŸ“Š å½“æ—¥æ€»ç»“</button>
<button onclick="show('family')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­</button>
</div>

<div class="main">

<div class="card">
<h2>ğŸ“… è®°å½•æ—¥æœŸ</h2>
<input id="date" type="date">
</div>

<!-- ä½“é‡ -->
<div class="page" id="weight">
<div class="card">
<h2>âš–ï¸ ä½“é‡è®°å½•</h2>
<input id="weightVal" type="number" step="0.1" placeholder="ä½“é‡ kg">
<button class="primary" onclick="saveWeight()">ä¿å­˜ä½“é‡</button>
<div id="tip" class="tip"></div>
</div>
<div class="card">
<h2>æœ€è¿‘ 7 å¤©ä½“é‡</h2>
<div class="chart" id="weightChart"></div>
</div>
</div>

<!-- é¥®é£Ÿ -->
<div class="page" id="food" style="display:none">
<div class="card">
<h2>ğŸš é¥®é£Ÿè®°å½•</h2>
<input id="foodCal" type="number" placeholder="æ‘„å…¥ kcal">
<button class="primary" onclick="saveFood()">ä¿å­˜é¥®é£Ÿ</button>
</div>
<div class="card">
<h2>æœ€è¿‘ 7 å¤©é¥®é£Ÿ</h2>
<div class="chart" id="foodChart"></div>
</div>
</div>

<!-- è¿åŠ¨ -->
<div class="page" id="sport" style="display:none">
<div class="card">
<h2>ğŸƒ è¿åŠ¨è®°å½•</h2>
<input id="sportCal" type="number" placeholder="æ¶ˆè€— kcal">
<button class="primary" onclick="saveSport()">ä¿å­˜è¿åŠ¨</button>
</div>
<div class="card">
<h2>æœ€è¿‘ 7 å¤©è¿åŠ¨</h2>
<div class="chart" id="sportChart"></div>
</div>
</div>

<!-- å½“æ—¥æ€»ç»“ -->
<div class="page" id="summary" style="display:none">
<div class="card" id="summaryCard"></div>
</div>

<!-- å®¶åº­ -->
<div class="page" id="family" style="display:none">
<div class="card" id="familyList">
<h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­æ€»è§ˆ</h2>
</div>
</div>

</div>
</div>

<script>
const tips=[
"ä»Šå¤©æ˜¯ä¸€ä¸ªå¾ˆå‰åˆ©çš„æ—¥å­ âœ¨",
"èº«ä½“åœ¨æ…¢æ…¢ç§¯ç´¯å¥½è¿ ğŸŒ·",
"ä½ ä¸ºè‡ªå·±åšäº†ä¸€ä»¶å¥½äº‹ ğŸ€",
"å¹³ç¨³å°±æ˜¯è¿›æ­¥ï¼Œç»§ç»­ä¿æŒ ğŸ’—"
];

const store=JSON.parse(localStorage.getItem("healthStable")||"{}");
let currentUser="";
date.value=new Date().toISOString().slice(0,10);

function save(){localStorage.setItem("healthStable",JSON.stringify(store));}

function addUser(){
 const n=newUser.value.trim();
 if(!n)return;
 store[n]=store[n]||{};
 save();
 newUser.value="";
 loadUsers();
}

function loadUsers(){
 userSelect.innerHTML='<option value="">é€‰æ‹©ä½¿ç”¨è€…</option>';
 Object.keys(store).forEach(n=>{
  userSelect.innerHTML+=`<option>${n}</option>`;
 });
}
loadUsers();

function changeUser(){currentUser=userSelect.value;renderAll();}

function ensure(){
 if(!currentUser)return false;
 const d=date.value;
 store[currentUser][d]=store[currentUser][d]||{weight:null,food:0,sport:0};
 return true;
}

function saveWeight(){
 if(!ensure())return;
 store[currentUser][date.value].weight=Number(weightVal.value);
 save();
 tip.innerText=tips[Math.floor(Math.random()*tips.length)];
 renderAll();
}

function saveFood(){
 if(!ensure())return;
 store[currentUser][date.value].food=Number(foodCal.value||0);
 save();renderAll();
}

function saveSport(){
 if(!ensure())return;
 store[currentUser][date.value].sport=Number(sportCal.value||0);
 save();renderAll();
}

function renderBars(target,values){
 target.innerHTML="";
 const max=Math.max(...values,1);
 values.forEach(v=>{
  const b=document.createElement("div");
  b.className="bar";
  b.style.setProperty("--h",(v/max*100)+"%");
  target.appendChild(b);
 });
}

function renderWeight(){
 if(!currentUser)return;
 const days=Object.entries(store[currentUser]).slice(-7);
 renderBars(weightChart,days.map(d=>d[1].weight||0));
 renderBars(foodChart,days.map(d=>d[1].food||0));
 renderBars(sportChart,days.map(d=>d[1].sport||0));
}

function renderSummary(){
 if(!currentUser)return;
 const d=store[currentUser][date.value];
 summaryCard.innerHTML=d?
 `<h2>ğŸ“Š å½“æ—¥æ€»ç»“</h2>
  âš–ï¸ ä½“é‡ï¼š${d.weight ?? "--"} kg<br>
  ğŸš é¥®é£Ÿï¼š${d.food} kcal<br>
  ğŸƒ è¿åŠ¨ï¼š${d.sport} kcal<br><br>
  ğŸŒ¸ ${tips[Math.floor(Math.random()*tips.length)]}`
 :"<h2>ğŸ“Š å½“æ—¥æ€»ç»“</h2>ä»Šå¤©è¿˜æ²¡æœ‰è®°å½•å“¦ ğŸŒ±";
}

function renderFamily(){
 familyList.innerHTML="<h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­æ€»è§ˆ</h2>";
 Object.keys(store).forEach(n=>{
  const last=Object.values(store[n]).slice(-1)[0];
  familyList.innerHTML+=`
  <div style="font-size:18px;margin-bottom:10px">
   ${n} ï½œ âš–ï¸ ${last?.weight ?? "--"} ï½œ ğŸš ${last?.food ?? 0} ï½œ ğŸƒ ${last?.sport ?? 0}
  </div>`;
 });
}

function renderAll(){
 renderWeight();
 renderSummary();
 renderFamily();
}

function show(id){
 document.querySelectorAll(".page").forEach(p=>p.style.display="none");
 document.getElementById(id).style.display="block";
 renderAll();
}
</script>
</body>
</html>
