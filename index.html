<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="å¥åº·å°æœ¬æœ¬">
<title>å¥åº·å°æœ¬æœ¬</title>

<style>
:root{
 --pink:#ff8fb1;
 --purple:#a78bfa;
 --blue:#67e8f9;
 --bg:#f6f7fb;
 --card:#ffffff;
 --text:#222;
}

body{
 margin:0;
 font-family:-apple-system,BlinkMacSystemFont,"PingFang SC";
 background:var(--bg);
 color:var(--text);
 overflow:hidden;
}

/* é¡¶éƒ¨æ  */
.header{
 height:60px;
 display:flex;
 align-items:center;
 justify-content:space-between;
 padding:0 20px;
 background:#fff;
 box-shadow:0 4px 20px rgba(0,0,0,.08);
 z-index:10;
}

.header h1{
 font-size:20px;
 margin:0;
}

.header button{
 background:none;
 border:none;
 font-size:22px;
}

/* æŠ½å±‰ */
.drawer{
 position:fixed;
 top:0;left:0;
 height:100%;
 width:280px;
 background:linear-gradient(180deg,var(--pink),var(--purple));
 color:#fff;
 transform:translateX(-100%);
 transition:.35s ease;
 z-index:20;
 padding:24px;
}

.drawer.open{transform:translateX(0);}

.drawer h2{margin-top:0;}

.drawer button{
 width:100%;
 margin-bottom:12px;
 padding:14px;
 border:none;
 border-radius:14px;
 background:#ffffff33;
 color:#fff;
 font-size:16px;
}

.mask{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.3);
 display:none;
 z-index:15;
}
.mask.show{display:block;}

/* ä¸»å†…å®¹ */
.main{
 height:calc(100vh - 60px);
 overflow:auto;
 padding:24px;
}

.card{
 background:var(--card);
 border-radius:26px;
 padding:24px;
 margin-bottom:22px;
 box-shadow:0 20px 40px rgba(0,0,0,.12);
}

h2{margin-top:0;}

input{
 width:100%;
 padding:16px;
 border-radius:16px;
 border:1px solid #ddd;
 margin-bottom:14px;
 font-size:17px;
}

.primary{
 width:100%;
 padding:16px;
 border-radius:999px;
 border:none;
 background:linear-gradient(135deg,var(--pink),var(--purple));
 color:#fff;
 font-size:17px;
}

.chart{
 height:260px;
 display:flex;
 align-items:flex-end;
 gap:10px;
}

.bar{
 flex:1;
 background:linear-gradient(180deg,var(--blue),var(--purple));
 border-radius:12px 12px 6px 6px;
 animation:grow .6s ease forwards;
}

@keyframes grow{
 from{height:0}
 to{height:var(--h)}
}

.page{display:none;}
.page.active{display:block;}
</style>
</head>

<body>

<!-- æŠ½å±‰ -->
<div class="drawer" id="drawer">
<h2>å¥åº·å°æœ¬æœ¬</h2>
<button onclick="show('weight')">âš–ï¸ ä½“é‡</button>
<button onclick="show('food')">ğŸš é¥®é£Ÿ</button>
<button onclick="show('sport')">ğŸƒ è¿åŠ¨</button>
<button onclick="show('summary')">ğŸ“Š æ€»ç»“</button>
<button onclick="show('family')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­</button>
</div>

<div class="mask" id="mask" onclick="toggleDrawer()"></div>

<!-- é¡¶éƒ¨ -->
<div class="header">
<button onclick="toggleDrawer()">â˜°</button>
<h1>å¥åº·å°æœ¬æœ¬</h1>
<button>âš™ï¸</button>
</div>

<!-- ä¸»ä½“ -->
<div class="main">

<div class="card">
<input id="date" type="date">
</div>

<div class="page active" id="weight">
<div class="card">
<h2>ä½“é‡</h2>
<input id="weightVal" type="number" placeholder="ä½“é‡ kg">
<button class="primary" onclick="saveWeight()">ä¿å­˜ä½“é‡</button>
</div>
<div class="card">
<h2>æœ€è¿‘ 7 å¤©</h2>
<div class="chart" id="weightChart"></div>
</div>
</div>

<div class="page" id="food">
<div class="card">
<h2>é¥®é£Ÿ</h2>
<input id="foodCal" type="number" placeholder="æ‘„å…¥ kcal">
<button class="primary" onclick="saveFood()">ä¿å­˜é¥®é£Ÿ</button>
</div>
</div>

<div class="page" id="sport">
<div class="card">
<h2>è¿åŠ¨</h2>
<input id="sportCal" type="number" placeholder="æ¶ˆè€— kcal">
<button class="primary" onclick="saveSport()">ä¿å­˜è¿åŠ¨</button>
</div>
</div>

<div class="page" id="summary">
<div class="card" id="summaryCard"></div>
</div>

<div class="page" id="family">
<div class="card" id="familyList"></div>
</div>

</div>

<script>
const store=JSON.parse(localStorage.getItem("healthStable")||"{}");
let currentUser=Object.keys(store)[0]||"æˆ‘";
store[currentUser]=store[currentUser]||{};
date.value=new Date().toISOString().slice(0,10);

function save(){localStorage.setItem("healthStable",JSON.stringify(store));}

function ensure(){
 const d=date.value;
 store[currentUser][d]=store[currentUser][d]||{weight:null,food:0,sport:0};
}

function saveWeight(){
 ensure();
 store[currentUser][date.value].weight=Number(weightVal.value);
 save();render();
}
function saveFood(){
 ensure();
 store[currentUser][date.value].food=Number(foodCal.value||0);
 save();
}
function saveSport(){
 ensure();
 store[currentUser][date.value].sport=Number(sportCal.value||0);
 save();
}

function render(){
 weightChart.innerHTML="";
 const days=Object.entries(store[currentUser]).slice(-7);
 const max=Math.max(...days.map(d=>d[1].weight||0),1);
 days.forEach(d=>{
  const b=document.createElement("div");
  b.className="bar";
  b.style.setProperty("--h",(d[1].weight/max*100)+"%");
  weightChart.appendChild(b);
 });
 summaryCard.innerHTML=`
  <h2>ä»Šæ—¥æ€»ç»“</h2>
  âš–ï¸ ${store[currentUser][date.value]?.weight ?? "--"} kg<br>
  ğŸš ${store[currentUser][date.value]?.food ?? 0} kcal<br>
  ğŸƒ ${store[currentUser][date.value]?.sport ?? 0} kcal
 `;
}

function toggleDrawer(){
 drawer.classList.toggle("open");
 mask.classList.toggle("show");
}

function show(id){
 document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 toggleDrawer();
 render();
}

render();
</script>
</body>
</html>
