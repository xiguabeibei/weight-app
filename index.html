<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="å¥åº·å°æœ¬æœ¬">
<title>å¥åº·å°æœ¬æœ¬</title>

<style>
:root{
 --pink:#ff8fb1;
 --purple:#a78bfa;
 --blue:#67e8f9;
 --bg:linear-gradient(160deg,#fff1f7,#eef4ff);
 --card:#ffffffee;
 --text:#222;
}
body{
 margin:0;
 font-family:-apple-system,BlinkMacSystemFont,"PingFang SC";
 background:var(--bg);
 color:var(--text);
}
.app{display:flex;height:100vh;}
.sidebar{
 width:260px;
 padding:26px;
 background:linear-gradient(180deg,var(--pink),var(--purple));
 color:#fff;
}
.sidebar h1{margin-bottom:14px;}
.sidebar select{
 width:100%;
 padding:12px;
 border-radius:14px;
 border:none;
 margin-bottom:16px;
}
.sidebar button{
 width:100%;
 margin-bottom:10px;
 padding:14px;
 border:none;
 border-radius:14px;
 background:#ffffff33;
 color:#fff;
}
.main{flex:1;padding:30px;overflow:auto;}
.card{
 background:var(--card);
 border-radius:28px;
 padding:22px;
 margin-bottom:22px;
 box-shadow:0 20px 40px rgba(0,0,0,.15);
}
input{
 width:100%;
 padding:14px;
 border-radius:14px;
 border:1px solid #ddd;
 margin-bottom:12px;
}
.primary{
 background:linear-gradient(135deg,var(--pink),var(--purple));
 color:#fff;
 border:none;
 padding:14px;
 border-radius:999px;
 width:100%;
}
.chart{
 height:260px;
 display:flex;
 align-items:flex-end;
 gap:10px;
}
.bar{
 flex:1;
 background:linear-gradient(180deg,var(--blue),var(--purple));
 border-radius:12px 12px 6px 6px;
 animation:grow .6s ease forwards;
}
@keyframes grow{from{height:0}to{height:var(--h)}}
.tip{font-size:18px;color:var(--pink);}
</style>
</head>

<body>
<div class="app">

<div class="sidebar">
<h1>å¥åº·å°æœ¬æœ¬</h1>

<select id="userSelect" onchange="changeUser()">
<option value="">é€‰æ‹©ä½¿ç”¨è€…</option>
</select>

<input id="newUser" placeholder="æ–°å¢å®¶åº­æˆå‘˜">
<button onclick="addUser()">æ·»åŠ æˆå‘˜</button>

<button onclick="show('weight')">âš–ï¸ ä½“é‡</button>
<button onclick="show('food')">ğŸš é¥®é£Ÿ</button>
<button onclick="show('sport')">ğŸƒ è¿åŠ¨</button>
<button onclick="show('family')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­</button>
</div>

<div class="main">

<div class="card">
ğŸ“… <input id="date" type="date">
</div>

<div class="page" id="weight">
<div class="card">
<h2>ä½“é‡è®°å½•</h2>
<input id="weightVal" type="number" step="0.1" placeholder="ä½“é‡ kg">
<button class="primary" onclick="saveWeight()">ä¿å­˜ä½“é‡</button>
<div id="tip" class="tip"></div>
</div>
<div class="card">
<h2>æœ€è¿‘ 7 å¤©</h2>
<div class="chart" id="weightChart"></div>
</div>
</div>

<div class="page" id="food" style="display:none">
<div class="card">
<h2>é¥®é£Ÿ</h2>
<input id="foodCal" type="number" placeholder="æ‘„å…¥å¡è·¯é‡Œ">
<button class="primary" onclick="saveFood()">ä¿å­˜é¥®é£Ÿ</button>
</div>
</div>

<div class="page" id="sport" style="display:none">
<div class="card">
<h2>è¿åŠ¨</h2>
<input id="sportCal" type="number" placeholder="æ¶ˆè€—å¡è·¯é‡Œ">
<button class="primary" onclick="saveSport()">ä¿å­˜è¿åŠ¨</button>
</div>
</div>

<div class="page" id="family" style="display:none">
<div class="card" id="familyList"></div>
</div>

</div>
</div>

<script>
const tips=[
"ä»Šå¤©ä¹Ÿæ˜¯è¢«å¥½è¿çœ·é¡¾çš„ä¸€å¤© âœ¨",
"èº«ä½“åœ¨æ‚„æ‚„å˜å¥½å“¦ ğŸŒ·",
"æ…¢æ…¢æ¥ï¼Œä½†ä¸€ç›´åœ¨å‘å‰ ğŸƒ",
"ä½ å·²ç»åœ¨å˜æ›´å¥½çš„è·¯ä¸Š ğŸ’—"
];

const store=JSON.parse(localStorage.getItem("healthStable")||"{}");
let currentUser="";
date.value=new Date().toISOString().slice(0,10);

function save(){localStorage.setItem("healthStable",JSON.stringify(store));}

function addUser(){
 const n=newUser.value.trim();
 if(!n)return;
 store[n]=store[n]||{};
 save();
 newUser.value="";
 loadUsers();
}

function loadUsers(){
 userSelect.innerHTML='<option value="">é€‰æ‹©ä½¿ç”¨è€…</option>';
 Object.keys(store).forEach(n=>{
  userSelect.innerHTML+=`<option>${n}</option>`;
 });
}
loadUsers();

function changeUser(){
 currentUser=userSelect.value;
 renderAll();
}

function ensure(){
 if(!currentUser)return false;
 const d=date.value;
 store[currentUser][d]=store[currentUser][d]||{weight:null,food:0,sport:0};
 return true;
}

function saveWeight(){
 if(!ensure())return;
 store[currentUser][date.value].weight=Number(weightVal.value);
 save();
 tip.innerText=tips[Math.floor(Math.random()*tips.length)];
 renderWeight();
 renderFamily();
}

function saveFood(){
 if(!ensure())return;
 store[currentUser][date.value].food+=Number(foodCal.value||0);
 save();
}

function saveSport(){
 if(!ensure())return;
 store[currentUser][date.value].sport+=Number(sportCal.value||0);
 save();
}

function renderWeight(){
 weightChart.innerHTML="";
 if(!currentUser)return;
 const days=Object.entries(store[currentUser]).slice(-7);
 const max=Math.max(...days.map(e=>e[1].weight||0),1);
 days.forEach(e=>{
  const b=document.createElement("div");
  b.className="bar";
  b.style.setProperty("--h",(e[1].weight/max*100)+"%");
  weightChart.appendChild(b);
 });
}

function renderFamily(){
 familyList.innerHTML="";
 Object.keys(store).forEach(n=>{
  const last=Object.values(store[n]).slice(-1)[0];
  familyList.innerHTML+=`<div>${n}ï¼š${last?.weight||"--"} kg</div>`;
 });
}

function renderAll(){
 renderWeight();
 renderFamily();
}

function show(id){
 document.querySelectorAll(".page").forEach(p=>p.style.display="none");
 document.getElementById(id).style.display="block";
}
</script>
</body>
</html>
