<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="ä½“é‡æœ¬">

<title>ä½“é‡æœ¬ ğŸ’—</title>

<style>
:root{
  --pink:#ff8fb1;
  --bg:#fff7fb;
  --card:#ffffff;
  --text:#222;
  --sub:#777;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0f0f12;
    --card:#1c1c22;
    --text:#f2f2f2;
    --sub:#aaa;
  }
}

body{
  margin:0;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Hiragino Sans",sans-serif;
  color:var(--text);
}

.app{
  padding:22px;
  padding-bottom:130px;
}

h1{
  font-size:28px;
  margin:6px 0 14px;
}

.card{
  background:var(--card);
  border-radius:28px;
  padding:22px;
  margin-bottom:20px;
  box-shadow:0 12px 30px rgba(0,0,0,.12);
}

input,select{
  width:100%;
  padding:18px;
  border-radius:20px;
  border:1px solid #eee;
  font-size:18px;
  margin-bottom:14px;
  box-sizing:border-box;
  background:transparent;
  color:var(--text);
}

button{
  width:100%;
  padding:18px;
  border-radius:999px;
  background:var(--pink);
  color:#fff;
  border:none;
  font-size:18px;
}

.big{
  font-size:48px;
  font-weight:800;
  color:var(--pink);
  margin-top:12px;
}

.tip{
  font-size:16px;
  color:var(--sub);
  margin-top:6px;
}

.record{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:14px;
}

.record button{
  width:auto;
  padding:8px 16px;
  font-size:14px;
  background:#4442;
  color:var(--sub);
}

.tabs{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  background:var(--card);
  border-top:1px solid #eee;
}

.tabs button{
  flex:1;
  border:none;
  background:none;
  padding:18px 0 14px;
  font-size:16px;
}

.page{
  display:none;
  animation:fade .25s ease;
}
.page.active{display:block;}

@keyframes fade{
  from{opacity:.6;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

.streak{
  font-size:20px;
  color:var(--pink);
  animation:pop .4s ease;
}

@keyframes pop{
  from{transform:scale(.8);opacity:.5}
  to{transform:scale(1);opacity:1}
}
</style>
</head>

<body>
<div class="app">

<!-- ä»Šæ—¥ -->
<div class="page active" id="home">
  <h1 id="quote">ä»Šå¤©ä¹Ÿè¦æ¸©æŸ”ä¸€ç‚¹ ğŸŒ·</h1>

  <div class="card">
    <select id="who">
      <option value="me">æˆ‘</option>
      <option value="ta">TA</option>
    </select>

    <input id="weight" type="number" step="0.1" placeholder="ä»Šå¤©çš„ä½“é‡ kg">
    <input id="note" placeholder="å¤‡æ³¨ï¼ˆåƒå¤šäº† / è¿åŠ¨äº†ï¼‰">
    <button onclick="save()">ä¿å­˜ä»Šå¤©</button>

    <div class="big" id="today">-- kg</div>
    <div class="tip" id="date"></div>
    <div class="streak" id="streak"></div>
  </div>
</div>

<!-- è®°å½• -->
<div class="page" id="listPage">
  <h1>è®°å½• ğŸ“–</h1>
  <div class="card" id="list"></div>
</div>

<!-- è®¾ç½® -->
<div class="page" id="setting">
  <h1>è®¾ç½® âš™ï¸</h1>
  <div class="card">
    <div class="tip">æ·±è‰²æ¨¡å¼è·Ÿéšç³»ç»Ÿ</div>
  </div>
</div>

</div>

<div class="tabs">
  <button onclick="show('home')">ğŸ <br>ä»Šå¤©</button>
  <button onclick="show('listPage')">ğŸ“–<br>è®°å½•</button>
  <button onclick="show('setting')">âš™ï¸<br>è®¾ç½®</button>
</div>

<script>
const today=new Date().toISOString().slice(0,10);
const data=JSON.parse(localStorage.getItem("data")||"{}");

const quotes=[
 "æ…¢æ…¢æ¥ï¼Œä½ å·²ç»å¾ˆå¥½äº† ğŸ’—",
 "ä¸æ˜¯é€€æ­¥ï¼Œæ˜¯èº«ä½“åœ¨é€‚åº” ğŸŒ±",
 "ä»Šå¤©çš„ä½ ä¹Ÿåœ¨åŠªåŠ› âœ¨",
 "æ¯ä¸€æ¡è®°å½•éƒ½ç®—æ•° ğŸ“–",
 "æ¸©æŸ”å¯¹å¾…è‡ªå·± ğŸ§¸"
];

function show(id){
 document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
 document.getElementById(id).classList.add("active");
}

function save(){
 const w=weight.value;
 if(!w) return;
 data[today]=data[today]||{};
 data[today].me={w,note:note.value};
 localStorage.setItem("data",JSON.stringify(data));
 load();
}

function load(){
 date.innerText=today;
 if(data[today]) todayEl.innerText=data[today].me.w+" kg";
 quote.innerText=quotes[new Date().getDate()%quotes.length];
 calcStreak();
 renderList();
}

function calcStreak(){
 let s=0;
 let d=new Date();
 while(true){
  const key=d.toISOString().slice(0,10);
  if(data[key]){s++; d.setDate(d.getDate()-1);}
  else break;
 }
 streak.innerText=s>1?`ğŸ”¥ è¿ç»­è®°å½• ${s} å¤©`:"";
}

function renderList(){
 list.innerHTML="";
 Object.keys(data).sort().reverse().forEach(d=>{
  const r=data[d].me;
  if(!r) return;
  const div=document.createElement("div");
  div.className="record";
  div.innerHTML=`<span>${d} Â· ${r.w}kg ${r.note||""}</span>
  <button onclick="del('${d}')">åˆ </button>`;
  list.appendChild(div);
 });
}

function del(d){
 delete data[d];
 localStorage.setItem("data",JSON.stringify(data));
 load();
}

const weight=document.getElementById("weight");
const note=document.getElementById("note");
const todayEl=document.getElementById("today");
const date=document.getElementById("date");
const list=document.getElementById("list");
const streak=document.getElementById("streak");
const quote=document.getElementById("quote");

load();
</script>
</body>
</html>
